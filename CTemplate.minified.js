var CTemplate=function(){this.parseTemplate=function(b){var e=[];b=b.replace(/\{eval\}([\s\S]*?)\{\/eval\}/g,function(b,c){e.push(c);return"{eval}{/eval}"}).replace(/\$\{([^\|^\}]+(\([^\)]+\))?)\s?\s?([^\}]*)?\}/ig,function(b,c,d,a){a&&a.replace(/\|([^\|^\:]+):?((([^,^\|]),?)*)/g,function(b,f,a){c='__M__("'+f+'", '+c+(a?","+a.split(/[\,\:]/g).join(","):"")+")"});return"</ESCAPE>'+("+c+")+'<ESCAPE>"}).replace(/\{(\/?\w+(\([^\)]+\))?)\s?\s?([^\}]*)?\}/ig,function(b,c,d,a){switch(c){case "var":return"</ESCAPE>';var "+
a+"; __TMPL__+='<ESCAPE>";case "if":return"</ESCAPE>';if("+a+") {__TMPL__+='<ESCAPE>";case "elseif":return"</ESCAPE>'}else if("+a+") {__TMPL__+='<ESCAPE>";case "/if":return"</ESCAPE>'}; __TMPL__+='<ESCAPE>";case "else":return"</ESCAPE>'}else{__TMPL__+='<ESCAPE>";case "for":return a.replace(/(\w+)\sin\s(.*)/,function(b,a,c){return"</ESCAPE>'; var __LIST__KEY__COUNT__=0;var __LIST__"+a+"="+c+";if(typeof __LIST__"+a+"=='object')for(var "+a+"_index in __LIST__"+a+"){__LIST__KEY__COUNT__++;var "+a+"=__LIST__"+
a+"["+a+"_index]; __TMPL__+='<ESCAPE>"});case "/for":return"</ESCAPE>'}; __TMPL__+='<ESCAPE>";case "forelse":return"</ESCAPE>'}; if(!__LIST__KEY__COUNT__){__TMPL__+='<ESCAPE>";case "macro":return"</ESCAPE>'; function "+a+"{var __TMPL__=''; __TMPL__+='<ESCAPE>";case "/macro":return"</ESCAPE>'; return __TMPL__}; __TMPL__+='<ESCAPE>";default:return b}}).replace(/\{eval\}\{\/eval\}/igm,function(b){return"</ESCAPE>';"+e.shift()+";\n __TMPL__+='<ESCAPE>"});b='function __M__(f){try{var args=Array.prototype.slice.call(arguments).slice(1);return (typeof f == "function") ? f.apply(this,args) : __M__[f].apply(this,args);}catch(e){debug(f+"::"+e.message);return arguments[1];}}__M__.eat=function(){return "";};__M__.escape=function(s){return String(s).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");};__M__.capitalize=function(s){return String(s).toUpperCase();};__M__["default"]=function(s,d){return s!=null?s:d;};\n'+
("this.process=function(__CONTEXT__){if(__CONTEXT__._MODIFIERS!=null){for(var key in __CONTEXT__._MODIFIERS)__M__[key]=__CONTEXT__._MODIFIERS[key]};with(__CONTEXT__){\nvar __TMPL__='';__TMPL__+='<ESCAPE>"+b+"</ESCAPE>';\nreturn __TMPL__;}}");b=b.replace(/(\<ESCAPE\>)([\s\S]*?)(\<\/ESCAPE\>)/g,function(b,c,d){return d.replace(/(['\\])/g,"\\$1").replace(/\n/g,"\\n")});try{return new (Function(b))}catch(g){return debug(g),debug(b),null}};return this}();
